include(cc_library)
include(cc_test)


cc_library(
  NAME 
    rotary_embedding
  HDRS
    rotary_embedding.h
  SRCS
    rotary_embedding.cpp
  DEPS
    :state_dict
    :block
    :kv_cache
    :prefix_cache
    glog::glog
    gflags::gflags
    torch
)

cc_library(
  NAME 
    layers
  HDRS
    embedding.h
    normalization.h
    linear.h
    linear_impl.h
    weight_utils.h
  SRCS
    linear.cpp
    linear_impl.cpp
    weight_utils.cpp
  DEPS
    :parallel_state
    :state_dict
    :kv_cache
    :prefix_cache
    :block
    :rotary_embedding
    glog::glog
    gflags::gflags
    torch
)

if(USE_NPU)
  add_subdirectory(npu)
endif()
