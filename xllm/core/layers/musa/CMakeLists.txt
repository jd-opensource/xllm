include(cc_library)

cc_library(
  NAME
    musa_layers
  HDRS
    musa_layer_base.h
    musa_qwen3_decoder_layer_impl.h
    musa_lm_head_impl.h
    musa_attention.h
    musa_mlp.h
    attention.h
    flashinfer_workspace.h
  SRCS
    musa_qwen3_decoder_layer_impl.cpp
    musa_lm_head_impl.cpp
    musa_attention.cpp
    musa_mlp.cpp
    attention.cpp
    flashinfer_workspace.cpp
  DEPS
    "-Wl,--whole-archive"
    "-Wl,--no-whole-archive"
    kv_cache
    state_dict
    model
    common
    torch
    torch_musa
    MTTOplib
)
