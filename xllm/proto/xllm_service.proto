syntax = "proto3";

option go_package = "jd.com/jd-infer/xllm;xllm";
package xllm.proto;
option cc_enable_arenas = true;
option cc_generic_services = true;

import "completion.proto";
import "chat.proto";
import "embedding.proto";
import "image_generation.proto";
import "rerank.proto";
import "models.proto";
import "anthropic.proto";

message HttpRequest {
};

message HttpResponse {
};

message RpcStatus {
  bool status = 1;
}

message MasterInfos {
  string model_id = 1;
  string model_path = 2;
  string master_node_addr = 3;
  int32 master_status = 4;
}

service XllmAPIService {
  rpc Completions (CompletionRequest) returns (CompletionResponse);
  rpc CompletionsHttp (HttpRequest) returns (HttpResponse);

  rpc ChatCompletions (ChatRequest) returns (ChatResponse);
  rpc ChatCompletionsHttp (HttpRequest) returns (HttpResponse);

  rpc Embeddings (EmbeddingRequest) returns (EmbeddingResponse);
  rpc EmbeddingsHttp (HttpRequest) returns (HttpResponse);

  rpc ImageGeneration(ImageGenerationRequest) returns (ImageGenerationResponse);
  rpc ImageGenerationHttp(HttpRequest) returns (HttpResponse);

  rpc Rerank (RerankRequest) returns (RerankResponse);
  rpc RerankHttp (HttpRequest) returns (HttpResponse);
  
  rpc Models (ModelListRequest) returns (ModelListResponse);
  rpc ModelsHttp (HttpRequest) returns (HttpResponse);

  rpc ModelVersionsHttp (HttpRequest) returns (HttpResponse);

  rpc AnthropicMessagesHttp (HttpRequest) returns (HttpResponse);

  rpc ForkMaster (MasterInfos) returns (RpcStatus);
  rpc ForkMasterHttp (HttpRequest) returns (HttpResponse);
  
  rpc Sleep (MasterInfos) returns (RpcStatus);
  rpc SleepHttp (HttpRequest) returns (HttpResponse);

  rpc Wakeup (MasterInfos) returns (RpcStatus);
  rpc WakeupHttp (HttpRequest) returns (HttpResponse);
};
